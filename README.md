# STM32 SPI Boost PID Controller (Schematic • PCB • Proteus)

A **SPI-based STM32 master–slave system** for **closed-loop PID control of a Boost converter**, maintaining a stable output voltage at a given setpoint and displaying key values on an **LCD1602**.

---

## Project Overview

This project uses **two STM32F103 microcontrollers** communicating via **SPI**:

### Master (STM32F103)
- Sends the **output-voltage setpoint** to the slave via SPI
- Receives **feedback (measured voltage/ADC value)** from the slave
- Displays **Setpoint / Actual voltage** on an **LCD1602**

### Slave (STM32F103)
- Measures the Boost output voltage using **ADC** (through a **voltage divider + RC low-pass filter**)
- Runs a **PID closed-loop controller** to update **PWM duty cycle**
- Returns the latest measured value back to the master via SPI

---

## System Architecture

Main operating flow:
1. The master updates the setpoint (e.g., via a push button).
2. The master transmits the setpoint to the slave using SPI.
3. The slave receives the setpoint, computes PID, and updates PWM to regulate the Boost output.
4. The slave prepares the latest measurement in `SPI_DR` for the next SPI transaction.
5. The master reads the feedback and updates the LCD display.

---

## Boost Converter (Open-Loop → Closed-Loop)

The Boost converter is implemented and tested in two stages:

### 1) Open-Loop Control
- PWM is generated by STM32 (timer peripheral).
- Duty cycle is adjusted (e.g., using ADC input from a potentiometer) to observe the duty–voltage relationship.

### 2) Closed-Loop PID Control
- A **voltage divider** scales the Boost output to ADC range.
- An **RC low-pass filter** is used to reduce noise and high-frequency components.
- A **digital PID controller** is used to maintain the output voltage under load variations.

> Practical note from experimentation: duty cycle should be clamped to a safe range to avoid stressing the MOSFET at high duty values.

---

## SPI Communication (Master ↔ Slave)

- Protocol: **SPI full-duplex**, Master–Slave model
- Typical configuration used: **CPOL = 0, CPHA = 0**, **16-bit frame**
- Control frame format (as used in the project):
  - **Upper 4 bits**: command ID (`0xA`)
  - **Lower 12 bits**: setpoint value  
  - Example: `0xA000 | (setpoint & 0x0FFF)`

The slave cannot “push” data by itself; it preloads the response value into `SPI_DR`. The master receives it on the next SPI clocking phase.

---

## Contents

This repository includes:
- Final report (theory, design, simulation, experiments)
- SPI master–slave firmware (PWM, ADC, SPI, PID, LCD)
- **Schematic**, **PCB layout**, and **Proteus simulation** (if included in your project files)

Suggested folder structure:
